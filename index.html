<link rel="stylesheet" type="text/css" href="style.css">

<script>
	const {ipcRenderer} = require('electron')

	console.log("INIT");

	profiles = [];
	selected = 0;
	"Basic window functions"
			function win_close(){
				ipcRenderer.send('window-close');
			}
			function win_max() {
				ipcRenderer.send('window-max');
			}
			function win_min() {
				ipcRenderer.send('window-min');
			}
	//-----------------------

	"Backend requests"
		function getProfiles(){
			ipcRenderer.send("get-profiles");
		}
	//-----------------------

	// Profile Data structure:
	// {
  //   "name":"Career",
  //   "version":"1.4.1",
  //   "mods":[
  //     "CKAN",
  //     "Game Data",
  //     "Mechjeb",
  //     "Kerbal engineer redux"
  //   ],
  //   "saves"[
  //     {
  //       "name":"Save 1",
  //       "mode":"Career",
  //       "flights":"100",
  //       "funds":"100",
  //       "science":"100",
  //       "rep":"100"
  //     }
  //   ]
  // }

	ipcRenderer.on("get-profiles", function(e, profiles, selected){
			displayProfiles(profiles, selected);
	})

	function displayProfiles(profiles, selected, search){
			window.profiles = profiles;
			window.selected = selected;
			var template =
				'<a onclick ="showProfile($ID)">\n\
				\t<div class="$SELECTEDprofile" id="$ID">\n\
				\t\t<h2>$NAME</h2>\n\
				\t\t<p>Version:$VERSION</p>\n\
				\t</div>\n\
				</a>\n';
			var out = "";
			for(var i=0; i<profiles.length; i++){
					out+=template.replace("$ID", i).replace("$ID", i)
	                     .replace("$SELECTED", (selected==i)?"selected ":"")
										   .replace("$NAME", profiles[i]["name"])
											 .replace("$VERSION", profiles[i]["version"]);
			}
		  document.getElementById("results").innerHTML=out;
 		}

		function showProfile(profile){
			document.getElementById(""+selected).className="profile";
			selected = profile;
			document.getElementById(""+profile).className="selected profile";
		}

</script>

<body>
  <!-- Header bar, contains config button and window buttons -->
  <header>
    <a class="close" id="close" onclick="win_close()">&times;</a>
    <a class="close" id="max" onclick="win_max()">&square;</a>
    <a class="close" id="min" onclick="win_min()">&#95;</a>
  </header>

  <search>
    <input type="text"/>
    <results id="results">

    </results>
  </search>
  <content>
    <header>
      <h1>Career</h1>
      <div style="margin-right:10%">
        <a class="" id="play">Play</a>
        <a class="" id="load">Load</a>
      </div>
    </header>

    <div class="flex">
      <article>
        <h1>Mods</h1>
        <ul id="mods">
          <li>CKAN</li>
          <li>Mechjeb</li>
        </ul>
      </article>

      <article style="flex-grow:5">
        <h1>Saves</h1>
        <ul id="saves">
          <li>CKAN</li>
          <li>Mechjeb</li>
        </ul>
      </article>
    </div>


  </content>

<script>

		var profiles = [
		  {
		    "name":"Career",
		    "version":"1.4.1",
		    "mods":[
		      "CKAN",
		      "Game Data",
		      "Mechjeb",
		      "Kerbal engineer redux"
		    ],
		    "saves":[
		      {
		        "name":"Save 1",
		        "mode":"Career",
		        "flights":"100",
		        "funds":"100",
		        "science":"100",
		        "rep":"100"
		      }
		    ]
		  },
		  {
		    "name":"Sanbox",
		    "version":"1.4.1",
		    "mods":[
		      "CKAN",
		      "Game Data",
		      "Mechjeb",
		      "Kerbal engineer redux"
		    ],
		    "saves":[
		      {
		        "name":"Save 1",
		        "mode":"Career",
		        "flights":"100",
		        "funds":"100",
		        "science":"100",
		        "rep":"100"
		      }
		    ]
		  },
		  {
		    "name":"Weapons",
		    "version":"1.4.1",
		    "mods":[
		      "CKAN",
		      "Game Data",
		      "Mechjeb",
		      "Kerbal engineer redux"
		    ],
		    "saves":[
		      {
		        "name":"Save 1",
		        "mode":"Career",
		        "flights":"100",
		        "funds":"100",
		        "science":"100",
		        "rep":"100"
		      }
		    ]
		  }
		];

		displayProfiles(profiles, 0, "")
</script>

</body>
