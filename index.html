<link rel="stylesheet" type="text/css" href="style.css">

<script>
const {ipcRenderer} = require('electron')

console.log("INIT");

function win_close(){
	ipcRenderer.send('window-close');
}
function win_max() {
	ipcRenderer.send('window-max');
}
function win_min() {
	ipcRenderer.send('window-min');
}
function win_launch(){
	ipcRenderer.send("window-launch");
	launchOverlay(true);
}

function win_config(){
	ipcRenderer.send("window-config");
}

function launchOverlay(state) {
	if(state)
	document.getElementById("launchOverlay").style.display = "block";
	else
	document.getElementById("launchOverlay").style.display = "none";
}

function configOverlay(state) {
	if(state){
		document.getElementById("configOverlay").style.display = "block";
		getconfig();
	}
	else{
		document.getElementById("configOverlay").style.display = "none";
		setconfig();
	}
}

function steamMode(){
	document.getElementById("ksp_path").disabled=true;
	document.getElementById("exeVersion").style.display='inline';
}

function manualMode(){
	document.getElementById("ksp_path").disabled=false;
	document.getElementById("exeVersion").style.display='none';
}

function setconfig(){
	var mode = "";
	var version = "";

	console.log(document.getElementById("installation_steam").checked);

	if(document.getElementById("installation_steam").checked)
		mode="steam";
	else
		mode='manual';

	if(document.getElementById("version_64").checked)
		version="64";
	else
		version="32";

	var name=document.getElementById("config_name").value;

	var config = {
		"name":name,
		"mode":mode,
		"version":version,
		"path":document.getElementById("ksp_path").value,
	}



	ipcRenderer.send("set-config", config);
}

function getconfig(){
	ipcRenderer.send("request-config");
}

ipcRenderer.on("get-config", function(event, arg) {
	console.log(arg);
	if(arg["mode"] == "steam"){
		document.getElementById("installation_steam").checked = true;
		steamMode();
	}
	else{
		document.getElementById("installation_manual").checked = true;
		manualMode();
	}

	if(arg["version"] == "64")
		document.getElementById("version_64").checked = true;
	else
		document.getElementById("version_32").checked = true;

	document.getElementById("ksp_path").value = arg["path"];

	document.getElementById("config_name").value = arg["name"];

});

function setExe(exe){
	document.getElementById("ksp_path").value = "C:\\Program Files (x86)\\Steam\\steamapps\\common\\Kerbal Space Program\\"+exe+".exe";
}

</script>

<body>
	<header>
      <a class="menu" id="config" onclick="configOverlay(true)"><div>&#9965;</div></a>
		<a class="close" id="close" onclick="win_close()">&times;</a>
		<a class="close" id="max" onclick="win_max()">&square;</a>
		<a class="close" id="min" onclick="win_min()">&#95;</a>
	</header>

	<div class="overlay" id="launchOverlay" >
		<content>
			<h1>Game Launched</h1>
			<br/><br/><br/><br/>
			<a onclick="launchOverlay(false)">Dismiss</a>
		</content>
	</div>

	<div class="overlay" id="configOverlay">
		<content>
			<h1>Launch Config</h1>
			<!-- <input type="text" class="largeText" id="config_name" value="NAME"></input> -->
			<div id="installMode">
				<br/>
				Installion mode:
				<label class="container">Steam
					<input type="radio" name="mode" checked='true' onchange="steamMode()" id="installation_steam">
					<span class="checkmark"></span>
				</label>
				<label class="container">Manual
					<input type="radio" name="mode" onchange="manualMode()" id="installation_manual">
					<span class="checkmark"></span>
				</label>
			</div>
			<div id="exeVersion" style="display:inline">
				<br/>
				Exe version:
				<label class="container">64 bit
					<input type="radio" name="exeVersion" checked='true' onchange="setExe('KSP_x64')" id="version_64">
					<span class="checkmark"></span>
				</label>
				<label class="container">32 bit
					<input type="radio" name="exeVersion" onchange="setExe('KSP')" id="version_32">
					<span class="checkmark"></span>
				</label>
			</div>

			<p>
				Path:
				<input type="text" class="text" id="ksp_path" value="C:\Program Files (x86)\Steam\steamapps\common\Kerbal Space Program\KSP_x64.exe" disabled></input>
			</p>

			<br/>
			<a onclick="configOverlay(false)">Confirm</a>
		</content>
	</div>


	<div class="profileName">[Name]<!--<a>&#9660;</a>--></div>
	<section class="overview">
		Version: 1.4.1<br/>
		Mods: 100<br/>
		Saves: 2<br/>
	</section>

	<div style="width:100%; height:100%">
	<section class="panel" id="mods">
		<h1>Mods</h1>
		<ul>
			<li>Item 1</li>
			<li>Item 2</li>
			<li>Item 3</li>
			<li>Item 4</li>
			<li>Item 5</li>
			<li>Item 6</li>
			<li>Item 1</li>
			<li>Item 2</li>
			<li>Item 3</li>
			<li>Item 4</li>
			<li>Item 5</li>
			<li>Item 6</li>
			<li>Item 1</li>
			<li>Item 2</li>
			<li>Item 3</li>
			<li>Item 4</li>
			<li>Item 5</li>
			<li>Item 6</li>
		</ul>
	</section>

	<section class="panel" id="saves">
		<h1>Saves</h1>
		<ul>
			<li>My first savegame<br/><span>Career</span></li>
			<li>Item 2</li>
			<li>Item 3</li>
			<li>Item 4</li>
			<li>Item 5</li>
			<li>Item 6</li>
			<li>Item 1</li>
			<li>Item 2</li>
			<li>Item 3</li>
			<li>Item 4</li>
		</ul>
	</section>
	</div>

	<footer>
		<a class="launch" onclick="win_launch()"><span>Launch!</span><img src="launch.svg"/></a>
	</footer>
</body>
